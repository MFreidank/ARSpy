from math import isclose

from arspy.hull import compute_segment_log_prob


def test_valid_inputs():

    # Extracted from julia during ars run
    inputs = {
        (float("-inf"), -2.0, 3.995999999999996, 3.991999999999992): -5.385293860786307,
        (-2.0, -1.996, 2.9939999999999998, 1.9920079999999998): -9.511458941845412,
        (-1.996, -1.331554369579719, 3.995999999999996, 3.9919999999999924): -2.787067766548189,
        (-1.331554369579719, -0.998, 0.998, 0.0): -2.2557840394005217,
        (-0.998, -0.499, 2.9939999999999998, 1.9920079999999998): -0.852818985564179,
        (-0.499, 0.0, -0.998, 0.0): -0.435835873134566,
        (0.0, 0.499, 0.998, 0.0): -0.435835873134566,
        (0.499, 0.998, -2.9939999999999998, 1.9920079999999998): -0.852818985564179,
        (0.998, 1.331554369579719, -0.998, 0.0): -2.2557840394005217,
        (1.331554369579719, 1.996, -3.995999999999996, 3.9919999999999924): -2.787067766548189,
        (1.996, 2.0, -2.9939999999999998, 1.9920079999999998): -9.511458941845412,
        (2.0, float("inf"), -3.995999999999996, 3.991999999999992): -5.385293860786307,
        (float("-inf"), -2.0, 3.995999999999996, 3.991999999999992): -5.385293860786307,
        (-2.0, -1.996, 3.239182414168663, 2.4813920986806512): -9.511948287831903,
        (-1.996, -1.5678575214165373, 3.995999999999996, 3.9919999999999924): -3.8577706539158045,
        (-1.5678575214165373, -1.243182414168663, 2.2411824141686627, 1.2406960493403254): -3.0122955757089214,
        (-1.243182414168663, -1.1071798899515684, 3.239182414168663, 2.4813920986806512): -3.312242525141375,
        (-1.1071798899515684, -0.998, 0.998, 0.0): -3.2647485123098097,
        (-0.998, -0.3830275330939491, 2.2411824141686627, 1.2406960493403254): -0.7151148681357585,
        (-0.3830275330939491, 0.0, -0.998, 0.0): -0.7624365689658402,
        (0.499, 0.998, -2.9939999999999998, 1.9920079999999998): -0.852818985564179,
        (0.998, 1.331554369579719, -0.998, 0.0): -2.2557840394005217,
        (1.331554369579719, 1.996, -3.995999999999996, 3.9919999999999924): -2.787067766548189,
        (1.996, 2.0, -2.9939999999999998, 1.9920079999999998): -9.511458941845412,
        (2.0, float("inf"), -3.995999999999996, 3.991999999999992): -5.385293860786307
    }

    for input_vals, julia_result in inputs.items():
        assert(isclose(julia_result, compute_segment_log_prob(*input_vals)))
